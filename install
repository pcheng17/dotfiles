#!/usr/bin/env bash

# Enter password beginning
sudo -v

set -e

OS=$(uname)

if ! command -v zsh > /dev/null; then
    if [[ $OS == "Linux" ]]; then
        apt install zsh
    elif [[ $OS == "Darwin" ]]; then
        brew install zsh
    fi
fi

CONFIG="conf.yaml"
DOTBOT_DIR="dotbot"

DOTBOT_BIN="bin/dotbot"
BASEDIR="$(cd "$(dirname "${BASH_SOURCE[0]}")" && pwd)"

cd "${BASEDIR}"
git -C "${DOTBOT_DIR}" submodule sync --quiet --recursive
git submodule update --init --recursive "${DOTBOT_DIR}"

"${BASEDIR}/${DOTBOT_DIR}/${DOTBOT_BIN}" -d "${BASEDIR}" -c "${CONFIG}" "${@}"

# Need to install the following, but methods will be based on OS
# neovim
# ripgrep
